SHELL = /bin/sh
CXX       :=g++
SDL2CFLAGS  := $(shell sdl2-config --cflags)
CXXFLAGS    :=-Wall -Wuninitialized -std=c++17 -g $(SDL2CFLAGS)
SDL2LDFLAGS := $(shell sdl2-config --libs)
LDFLAGS     := -L/usr/lib -Llib $(SDL2LDFLAGS)
BUILD       := ./build
OBJ_DIR     := $(BUILD)/objects
INCLUDE     := -Iinclude/
SRC         := $(wildcard ./src/*.cpp)
OBJECTS     := $(subst ./src/,$(OBJ_DIR)/, $(SRC:.cpp=.o))
EXE = breakwall
# sources=$(src)/Ball.cpp $(src)/Bare.cpp $(src)/Brick.cpp $(src)/GlobalConstants.cpp $(src)/main.cpp $(src)/ScoreSegments.cpp $(src)/TextureWithPosition.cpp $(src)/UtilConstants.cpp $(src)/Wall.cpp
# headers=$(src)/Ball.h $(src)/Bare.h $(src)/Brick.h $(src)/GlobalConstants.h $(src)/ScoreSegments.h $(src)/TextureWithPosition.h $(src)/UtilConstants.h $(src)/Wall.h
all: mkdirs link

#compile
$(subst ./src/,$(OBJ_DIR)/, $(SRC:%.cpp=%.o)): $(SRC)
	@echo "File sources : $<"
	@echo "Destination  : $@"
	$(CXX) $(CXXFLAGS) $(INCLUDE) -c $< -o $@

#Link
link: $(OBJECTS)
	$(CXX) $(CXXFLAGS) -o $(EXE)\
	build/objects/ScoreSegments.o \
	build/objects/Bare.o \ 
	build/objects/UtilConstants.o \ 
	build/objects/Wall.o \ 
	build/objects/TextureWithPosition.o \ 
	build/objects/Ball.o \ 
	build/objects/hello.o \ 
	build/objects/GlobalConstants.o \ 
	build/objects/main.o \ 
	build/objects/Brick.o \   
	$(LDFLAGS)

.PHONY: all mkdirs clean

mkdirs:
	mkdir -p $(OBJ_DIR)

clean:
	rm -rvf $(BUILD)/*